<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‚¹å‡»æŒ‰é’®è§¦å‘éŸ³æ•ˆ Â· ä¼˜é›…çš„å“”å“”å£°</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            background: linear-gradient(145deg, #f5f7fa 0%, #e9ecf2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Segoe UI', Roboto, system-ui, -apple-system, sans-serif;
            padding: 16px;
            margin: 0;
        }
        .card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-radius: 42px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25), inset 0 1px 2px rgba(255,255,255,0.6);
            padding: 40px 32px;
            width: 100%;
            max-width: 480px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.5);
        }
        h2 {
            font-weight: 500;
            font-size: 1.8rem;
            letter-spacing: -0.02em;
            color: #1e293b;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        h2 span {
            font-size: 2rem;
        }
        .description {
            color: #475569;
            margin-bottom: 32px;
            font-weight: 400;
            font-size: 1rem;
            border-bottom: 1px dashed #cbd5e1;
            padding-bottom: 20px;
        }
        .sound-button {
            background: #1e1e2f;
            border: none;
            background: linear-gradient(135deg, #2a2a40 0%, #1a1a2e 100%);
            box-shadow: 0 12px 28px -8px #0f0f1e, 0 4px 12px rgba(0,0,0,0.3), inset 0 2px 4px rgba(255,255,255,0.05);
            color: white;
            font-size: 1.6rem;
            font-weight: 600;
            padding: 24px 48px;
            border-radius: 60px;
            cursor: pointer;
            transition: all 0.15s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 14px;
            border: 1px solid rgba(255,215,0,0.2);
            letter-spacing: 0.5px;
            width: 100%;
            margin-bottom: 24px;
        }
        .sound-button:hover {
            background: linear-gradient(135deg, #2f2f4a 0%, #20203a 100%);
            transform: scale(1.02);
            box-shadow: 0 18px 32px -10px #0a0a18, 0 6px 14px rgba(0,0,0,0.4);
            border-color: rgba(255, 215, 0, 0.4);
        }
        .sound-button:active {
            transform: scale(0.98);
            box-shadow: 0 6px 16px -6px #0f0f1e, inset 0 3px 8px rgba(0,0,0,0.5);
            background: linear-gradient(135deg, #1d1d30 0%, #131325 100%);
        }
        .sound-button i {
            font-size: 2rem;
            filter: drop-shadow(0 2px 4px #00000050);
        }
        .tech-note {
            background: rgba(255,255,240,0.6);
            border-radius: 40px;
            padding: 16px 20px;
            font-size: 0.9rem;
            color: #334155;
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            border: 1px solid rgba(255,255,200,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            flex-wrap: wrap;
            margin-top: 8px;
        }
        .tech-note .badge {
            background: #2d3b4f;
            color: #f1f5f9;
            padding: 6px 14px;
            border-radius: 40px;
            font-size: 0.8rem;
            font-weight: 500;
            letter-spacing: 0.3px;
        }
        .footer-note {
            font-size: 0.85rem;
            color: #64748b;
            margin-top: 28px;
            border-top: 1px solid #cbd5e180;
            padding-top: 20px;
        }
        .footer-note code {
            background: #e2e8f0;
            padding: 4px 8px;
            border-radius: 30px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
        }
        /* æ¨¡æ‹ŸéŸ³é‡icon */
        .icon-sound {
            display: inline-block;
            width: 28px;
            height: 28px;
            background: currentColor;
            mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='currentColor'%3E%3Cpath d='M13.5 4.06c0-1.336-1.616-2.005-2.56-1.06l-4.5 4.5H4.508c-1.141 0-2.318.664-2.66 1.905A9.76 9.76 0 001.5 12c0 .898.121 1.768.35 2.595.341 1.24 1.518 1.905 2.659 1.905h1.93l4.5 4.5c.945.945 2.561.276 2.561-1.06V4.06zM18.584 5.106a.75.75 0 011.06 0c3.808 3.807 3.808 9.98 0 13.788a.75.75 0 11-1.06-1.06 8.25 8.25 0 000-11.668.75.75 0 010-1.06z'%3E%3C/path%3E%3C/svg%3E") no-repeat center;
            mask-size: contain;
            -webkit-mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='currentColor'%3E%3Cpath d='M13.5 4.06c0-1.336-1.616-2.005-2.56-1.06l-4.5 4.5H4.508c-1.141 0-2.318.664-2.66 1.905A9.76 9.76 0 001.5 12c0 .898.121 1.768.35 2.595.341 1.24 1.518 1.905 2.659 1.905h1.93l4.5 4.5c.945.945 2.561.276 2.561-1.06V4.06zM18.584 5.106a.75.75 0 011.06 0c3.808 3.807 3.808 9.98 0 13.788a.75.75 0 11-1.06-1.06 8.25 8.25 0 000-11.668.75.75 0 010-1.06z'%3E%3C/path%3E%3C/svg%3E") no-repeat center;
            -webkit-mask-size: contain;
            background-color: white;
        }
    </style>
</head>
<body>
    <div class="card">
        <h2>
            <span>ğŸ”Š</span> éŸ³æ•ˆæŒ‰é’®
        </h2>
        <div class="description">
            ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ï¼Œæ„Ÿå—ç”± Web Audio å®æ—¶åˆæˆçš„æ¸…æ¾ˆæç¤ºéŸ³
        </div>

        <!-- æ ¸å¿ƒæŒ‰é’® -->
        <button class="sound-button" id="magicButton">
            <i class="icon-sound"></i> ç‚¹å‡» Â· å“”
        </button>

        <div class="tech-note">
            <span class="badge">âœ¨ çº¯åˆæˆ</span>
            <span>æ— å¤–éƒ¨éŸ³é¢‘æ–‡ä»¶ Â· å³ç‚¹å³å“</span>
            <span class="badge">ğŸ¯ é˜²çˆ†éŸ³åŒ…ç»œ</span>
        </div>

        <div class="footer-note">
            <code>Web Audio API Â· 880Hz æ­£å¼¦æ³¢ Â· 150ms æ·¡å…¥æ·¡å‡º</code>
        </div>
    </div>

    <script>
        (function() {
            'use strict';

            // æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦æ”¯æŒ Web Audio API
            const AudioContextClass = window.AudioContext || window.webkitAudioContext;
            if (!AudioContextClass) {
                alert('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ Web Audio APIï¼Œæ— æ³•æ’­æ”¾éŸ³æ•ˆã€‚è¯·å‡çº§è‡³æœ€æ–°ç‰ˆæµè§ˆå™¨ã€‚');
                // å¦‚æœæŒ‰é’®å­˜åœ¨ï¼Œå¯ç¦ç”¨äº¤äº’ä½†ä¿ç•™æ ·å¼
                const btn = document.getElementById('magicButton');
                if (btn) {
                    btn.disabled = true;
                    btn.style.opacity = '0.5';
                    btn.style.cursor = 'not-allowed';
                    btn.title = 'æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘åŠŸèƒ½';
                }
                return; // ç»ˆæ­¢è„šæœ¬
            }

            // å…¨å±€ AudioContext æ‡’åŠ è½½ (ç¬¬ä¸€æ¬¡ç‚¹å‡»æ—¶åˆ›å»º)
            let audioCtx = null;

            // è·å–æŒ‰é’®
            const button = document.getElementById('magicButton');
            if (!button) return;

            // æŒ‰é’®ç‚¹å‡»äº‹ä»¶ â€”â€” æ’­æ”¾æ‚¦è€³çŸ­éŸ³
            button.addEventListener('click', function() {
                // 1. è‹¥æœªåˆ›å»º AudioContextï¼Œåˆ™ç«‹å³åˆ›å»ºï¼ˆåœ¨ç”¨æˆ·æ‰‹åŠ¿ä¸­åˆ›å»ºç¬¦åˆè§„èŒƒï¼‰
                if (!audioCtx) {
                    try {
                        audioCtx = new AudioContextClass();
                    } catch (e) {
                        console.error('AudioContext åˆ›å»ºå¤±è´¥:', e);
                        return;
                    }
                }

                // 2. ç¡®ä¿éŸ³é¢‘ä¸Šä¸‹æ–‡å¤„äºè¿è¡ŒçŠ¶æ€ï¼ˆresumeï¼‰ï¼Œç”¨æˆ·æ‰‹åŠ¿ä¸­è°ƒç”¨æ€»æ˜¯æˆåŠŸ
                audioCtx.resume().then(() => {
                    // 3. å½“å‰ä¸Šä¸‹æ–‡æ—¶é—´ (ç²¾ç¡®åˆ°äºšæ¯«ç§’)
                    const now = audioCtx.currentTime;

                    // 4. éŸ³æ•ˆå‚æ•°
                    const freq = 880;            // é¢‘ç‡ 880Hz (A5 éŸ³ç¬¦ï¼Œæ¸…è„†)
                    const duration = 0.15;        // æ€»æ—¶é•¿ 150ms
                    const fadeIn = 0.006;          // 6ms æ·¡å…¥ (é¿å…çˆ†ç ´éŸ³)
                    const fadeOut = 0.012;         // 12ms æ·¡å‡º (æ¶ˆé™¤å°¾éŸ³å’”å“’å£°)

                    // ç¡®ä¿æ·¡å…¥æ·¡å‡ºæ—¶é—´ä¸è¶…å‡ºæ€»æ—¶é•¿ (é˜²å¾¡æ€§ç¼–ç¨‹)
                    const safeFadeIn = Math.min(fadeIn, duration * 0.3);
                    const safeFadeOut = Math.min(fadeOut, duration * 0.3);
                    const plateauStart = now + safeFadeIn;
                    const plateauEnd = now + duration - safeFadeOut;

                    // 5. åˆ›å»ºæŒ¯è¡å™¨ (éŸ³æº) ä¸ å¢ç›ŠèŠ‚ç‚¹ (éŸ³é‡æ§åˆ¶)
                    const oscillator = audioCtx.createOscillator();
                    const gainNode = audioCtx.createGain();

                    // è®¾ç½®æŒ¯è¡å™¨ç±»å‹å’Œé¢‘ç‡
                    oscillator.type = 'sine';          // æ­£å¼¦æ³¢ï¼Œåœ†æ¶¦ä¸åˆºè€³
                    oscillator.frequency.value = freq;

                    // è¿æ¥èŠ‚ç‚¹: æŒ¯è¡å™¨ â†’ å¢ç›ŠèŠ‚ç‚¹ â†’ éŸ³é¢‘è¾“å‡º
                    oscillator.connect(gainNode);
                    gainNode.connect(audioCtx.destination);

                    // 6. åº”ç”¨éŸ³é‡åŒ…ç»œ (ç²¾ç»†çš„ gain å˜åŒ–ï¼Œæ¶ˆé™¤click)
                    // åˆå§‹é™éŸ³
                    gainNode.gain.setValueAtTime(0, now);
                    // å¿«é€Ÿæ·¡å…¥åˆ° 0.2 (20% éŸ³é‡ï¼Œè¶³å¤Ÿæ¸…æ™°ä¸”ä¸åµ)
                    gainNode.gain.linearRampToValueAtTime(0.2, plateauStart);
                    // ç»´æŒéŸ³é‡ç›´åˆ°æ·¡å‡ºå‰
                    gainNode.gain.setValueAtTime(0.2, plateauEnd);
                    // å¹³æ»‘æ·¡å‡ºåˆ°0
                    gainNode.gain.linearRampToValueAtTime(0, now + duration);

                    // 7. å®‰æ’æŒ¯è¡å™¨èµ·æ­¢
                    oscillator.start(now);
                    oscillator.stop(now + duration);

                    // 8. å£°éŸ³ç»“æŸåè‡ªåŠ¨æ¸…ç†èŠ‚ç‚¹ (å¯é€‰ï¼Œä½†å¥½ä¹ æƒ¯)
                    oscillator.onended = () => {
                        // æ–­å¼€è¿æ¥ï¼Œå…è®¸åƒåœ¾å›æ”¶
                        try {
                            oscillator.disconnect();
                            gainNode.disconnect();
                        } catch (e) {
                            // å¿½ç•¥æ¸…ç†æ—¶çš„å¾®å°é”™è¯¯
                        }
                    };

                }).catch(err => {
                    // å¦‚æœresumeå¤±è´¥ï¼ˆæå°‘è§æƒ…å†µï¼Œæ¯”å¦‚ç¡¬ä»¶è¢«å ç”¨ç­‰ï¼‰
                    console.warn('éŸ³é¢‘ä¸Šä¸‹æ–‡å¯åŠ¨å¤±è´¥:', err);
                });
            });

            // å¯é€‰ï¼šé¢„åŠ è½½/æç¤ºç”¨æˆ·é¦–æ¬¡ç‚¹å‡»éœ€è¦äº¤äº’ (å®é™…æ— é¢å¤–æ“ä½œ)
            // ä½†ä¸ºäº†æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œå¯ä»¥åœ¨é¦–æ¬¡é¼ æ ‡ç§»å…¥æŒ‰é’®æ—¶å°è¯•åˆå§‹åŒ–AudioContext?
            // ä½†å®é™…ä¸Šå»¶è¿Ÿåˆå§‹åŒ–å®Œå…¨è¶³å¤Ÿã€‚è¿™é‡ŒåŠ ä¸ªå°å½©è›‹: é¼ æ ‡æ‚¬åœæ—¶é¢„åˆ›å»ºä½†ä¿æŒsuspendedï¼Œå¯ç¼©çŸ­é¦–å“å»¶è¿Ÿã€‚
            // ä½†ä¸ºäº†é˜²æ­¢è¿‡åº¦è®¾è®¡ï¼Œä¿æŒç®€æ´ã€‚ä½†å¯ä»¥æ·»åŠ ä¸€ä¸ªæ‚¬åœâ€œé¢„çƒ­â€ (å¯é€‰ï¼Œéå¿…é¡»ï¼Œå¯ä»¥æ³¨é‡Šæ‰)
            // ä¸‹é¢çš„ä»£ç å®Œå…¨å¯é€‰ï¼šå½“é¼ æ ‡ç¬¬ä¸€æ¬¡ç§»å…¥æŒ‰é’®æ—¶ï¼Œæ— å£°åœ°åˆ›å»ºcontextï¼ˆä½†ä¸resumeï¼‰
            // è¿™æ ·é¦–æ¬¡ç‚¹å‡»æ—¶åªéœ€è¦resumeï¼Œé€Ÿåº¦æ›´å¿«ã€‚
            let warmedUp = false;
            button.addEventListener('mouseenter', function once() {
                if (!audioCtx && !warmedUp) {
                    // è½»è½»åˆ›å»ºï¼Œä½†ä¸resumeï¼Œä¿æŒsuspended
                    try {
                        audioCtx = new AudioContextClass();
                        warmedUp = true; // æ ‡è®°å·²é¢„çƒ­
                    } catch (e) {
                        // å¿½ç•¥ï¼Œä¸‹æ¬¡ç‚¹å‡»æ—¶ä¼šå†æ¬¡å°è¯•
                    }
                }
                // åªæ‰§è¡Œä¸€æ¬¡
                button.removeEventListener('mouseenter', once);
            }, { once: true });

        })();
    </script>
    <!-- 
        æ ¸å¿ƒæ€è·¯ï¼šWeb Audio API åˆæˆçº¯å‡€æ­£å¼¦æ³¢ + é˜²çˆ†éŸ³åŒ…ç»œã€‚
        æ— éœ€ä»»ä½•å¤–éƒ¨éŸ³é¢‘èµ„æºï¼Œå…¼å®¹æ‰€æœ‰ç°ä»£æµè§ˆå™¨ï¼Œä¸”ç¬¦åˆè‡ªåŠ¨æ’­æ”¾ç­–ç•¥ï¼ˆå®Œå…¨ç”±ç”¨æˆ·æ‰‹åŠ¿è§¦å‘ï¼‰ã€‚
        åŒ…ç»œ (gain æ¸å˜) å½»åº•æ¶ˆé™¤clickï¼Œå£°éŸ³æŸ”å’Œæ¸…æ™°ã€‚
    -->
</body>
</html>